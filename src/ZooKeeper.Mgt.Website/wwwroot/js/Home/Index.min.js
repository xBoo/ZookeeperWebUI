function init(){$.ajax({url:"/Home/GetNodes?path=/",type:"GET",datatype:"Json",success:function(n){n.businessCode!==-1?$.fn.zTree.init($("#zktree"),setting,n.returnObj):alert(n.businessMessage)},error:function(){alert("error")}})}function OnClick(n,t,i){var u=i.bakValue,r;$("#config-address").html(u);showNode(i);i.open===!1?expandNodes(i):(r=$.fn.zTree.getZTreeObj("zktree"),r.expandNode(i,!1,!0,!0))}function beforeExpand(n,t){return expandNodes(t),t.expand!==!1}function expandNodes(n){var t,i,r;n==null&&(t=$.fn.zTree.getZTreeObj("zktree"),n=t.getNodes()[0]);i=n.bakValue;r="/Home/GetNodes?path="+i+"&parentId="+n.id;$.ajax({url:r,type:"GET",datatype:"Json",success:function(t){t.businessCode!==-1?add(n,t.returnObj):alert(t.Message)},error:function(){alert("服务器访问错误")}})}function add(n,t){var i=$.fn.zTree.getZTreeObj("zktree");n&&(i.removeChildNodes(n),i.addNodes(n,t))}function showNode(n){var t,i,r;n==null&&(t=$.fn.zTree.getZTreeObj("zktree"),n=t.getNodes()[0]);i=n.bakValue;r="/Home/GetNode?path="+i;$.ajax({url:r,type:"GET",datatype:"Json",success:function(n){if(n.businessCode!==-1){var t=n.returnObj;$("#lb-path").text(t.path);$("#lb-version").text(t.version);$("#lb-createtime").text(t.createTime);$("#lb-modifytime").text(t.modifyTime);$("#lb-acl").text(t.acl);$("#lb-value").val(t.value);$("#lb-jsonvalue").val(t.value)}else alert(n.Message)},error:function(){alert("服务器访问错误")}})}function removeHoverDom(n,t){$("#addBtn_"+t.tId).unbind().remove()}function addHoverDom(n,t){var f=$("#"+t.tId+"_span"),r,u,i;t.editNameFlag||$("#addBtn_"+t.tId).length>0||(r=t.bakValue,u="<span class='button add' id='addBtn_"+t.tId+"' title='add node' onfocus='this.blur();'><\/span>",f.after(u),i=$("#addBtn_"+t.tId),i&&i.bind("click",function(){return $("#edit-path").val(r),$("#addModel").modal("show"),!0}))}var setting={view:{addHoverDom:addHoverDom,selectedMulti:!1},edit:{enable:!1,showRemoveBtn:!1,showRenameBtn:!1},data:{keep:{parent:!0,leaf:!0},simpleData:{enable:!0}},callback:{beforeExpand:beforeExpand,onClick:OnClick}},newCount;$(document).ready(function(){$("#btnEdit").bind("click",function(){var i=$("#lb-path").text(),n,t;n=$("#text").hasClass("active")?$("#lb-value").val():$("#lb-jsonvalue").val();t="/Home/UpdateNode";$.ajax({url:t,type:"Post",data:{path:i,value:n},success:function(n){n.businessCode!==-1?alert("success!"):alert(n.businessMessage)},error:function(){alert("error")}})});$("#btnDelete").bind("click",function(){var i=confirm("Are you sure？"),n,t;i!==!1&&(n=$("#lb-path").text(),t="/Home/DeleteNode?path="+n,$.ajax({url:t,type:"GET",datatype:"Json",success:function(n){n.businessCode!==-1?init():alert(n.businessMessage)},error:function(){alert("error")}}))});$("#btnAddModel").bind("click",function(){var t=$("#edit-path").val(),n=$("#edit-name").val(),i=$("#edit-value").val();if(n===""){alert("name can not be null");return}$.ajax({url:"/Home/CreateNode",type:"Post",datatype:"Json",data:{path:t+"/"+n,value:i,createModel:"PERSISTENT"},success:function(n){n.businessCode!==-1?init():alert(n.businessMessage)},error:function(){alert("error")}})});init()});newCount=1;